"use strict";
var ɵngcc0 = require('@angular/core');
var ɵngcc1 = require('@angular/common');
var ɵngcc2 = require('./inline-svg.config');
var ɵngcc3 = require('@angular/common/http');
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var common_1 = require("@angular/common");
var http_1 = require("@angular/common/http");
var core_1 = require("@angular/core");
var rxjs_1 = require("rxjs");
var operators_1 = require("rxjs/operators");
var inline_svg_config_1 = require("./inline-svg.config");
var i0 = require("@angular/core");
var i1 = require("@angular/common");
var i2 = require("./inline-svg.config");
var i3 = require("@angular/common/http");
var SVGCacheService = (function () {
    function SVGCacheService(_appBase, _location, _config, httpClient, httpBackend, rendererFactory) {
        this._appBase = _appBase;
        this._location = _location;
        this._config = _config;
        this._http = _config && !_config.bypassHttpClientInterceptorChain
            ? httpClient
            : new http_1.HttpClient(httpBackend);
        this._renderer = rendererFactory.createRenderer(null, null);
        this.setBaseUrl();
        if (!SVGCacheService_1._cache) {
            SVGCacheService_1._cache = new Map();
        }
        if (!SVGCacheService_1._inProgressReqs) {
            SVGCacheService_1._inProgressReqs = new Map();
        }
    }
    SVGCacheService_1 = SVGCacheService;
    SVGCacheService.prototype.getSVG = function (url, resolveSVGUrl, cache) {
        var _this = this;
        if (cache === void 0) { cache = true; }
        var svgUrl = resolveSVGUrl
            ? this.getAbsoluteUrl(url)
            : url;
        if (cache && SVGCacheService_1._cache.has(svgUrl)) {
            return rxjs_1.of(this._cloneSVG(SVGCacheService_1._cache.get(svgUrl)));
        }
        if (SVGCacheService_1._inProgressReqs.has(svgUrl)) {
            return SVGCacheService_1._inProgressReqs.get(svgUrl);
        }
        var req = this._http.get(svgUrl, { responseType: 'text' })
            .pipe(operators_1.finalize(function () {
            SVGCacheService_1._inProgressReqs.delete(svgUrl);
        }), operators_1.share(), operators_1.map(function (svgText) {
            var svgEl = _this._svgElementFromString(svgText);
            SVGCacheService_1._cache.set(svgUrl, svgEl);
            return _this._cloneSVG(svgEl);
        }));
        SVGCacheService_1._inProgressReqs.set(svgUrl, req);
        return req;
    };
    SVGCacheService.prototype.setBaseUrl = function () {
        if (this._config) {
            this._baseUrl = this._config.baseUrl;
        }
        else if (this._appBase !== null) {
            this._baseUrl = this._appBase;
        }
        else if (this._location !== null) {
            this._baseUrl = this._location.getBaseHrefFromDOM();
        }
    };
    SVGCacheService.prototype.getAbsoluteUrl = function (url) {
        if (this._baseUrl && !/^https?:\/\//i.test(url)) {
            url = this._baseUrl + url;
            if (url.indexOf('//') === 0) {
                url = url.substring(1);
            }
        }
        var base = this._renderer.createElement('BASE');
        base.href = url;
        return base.href;
    };
    SVGCacheService.prototype._svgElementFromString = function (str) {
        var div = this._renderer.createElement('DIV');
        div.innerHTML = str;
        var svg = div.querySelector('svg');
        if (!svg) {
            throw new Error('No SVG found in loaded contents');
        }
        return svg;
    };
    SVGCacheService.prototype._cloneSVG = function (svg) {
        return svg.cloneNode(true);
    };
    var SVGCacheService_1;
    SVGCacheService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function SVGCacheService_Factory() { return new SVGCacheService(i0.ɵɵinject(i1.APP_BASE_HREF, 8), i0.ɵɵinject(i1.PlatformLocation, 8), i0.ɵɵinject(i2.InlineSVGConfig, 8), i0.ɵɵinject(i3.HttpClient), i0.ɵɵinject(i3.HttpBackend), i0.ɵɵinject(i0.RendererFactory2)); }, token: SVGCacheService, providedIn: "root" });
    SVGCacheService = SVGCacheService_1 = __decorate([ __param(0, core_1.Optional()), __param(0, core_1.Inject(common_1.APP_BASE_HREF)),
        __param(1, core_1.Optional()),
        __param(2, core_1.Optional()),
        __metadata("design:paramtypes", [String, common_1.PlatformLocation,
            inline_svg_config_1.InlineSVGConfig,
            http_1.HttpClient,
            http_1.HttpBackend,
            core_1.RendererFactory2])
    ], SVGCacheService);
SVGCacheService.ɵfac = function SVGCacheService_Factory(t) { return new (t || SVGCacheService)(ɵngcc0.ɵɵinject(common_1.APP_BASE_HREF, 8), ɵngcc0.ɵɵinject(ɵngcc1.PlatformLocation, 8), ɵngcc0.ɵɵinject(ɵngcc2.InlineSVGConfig, 8), ɵngcc0.ɵɵinject(ɵngcc3.HttpClient), ɵngcc0.ɵɵinject(ɵngcc3.HttpBackend), ɵngcc0.ɵɵinject(ɵngcc0.RendererFactory2)); };
SVGCacheService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: SVGCacheService, factory: function (t) { return SVGCacheService.ɵfac(t); }, providedIn: 'root' });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SVGCacheService, [{
        type: core_1.Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: String, decorators: [{
                type: core_1.Optional
            }, {
                type: core_1.Inject,
                args: [common_1.APP_BASE_HREF]
            }] }, { type: ɵngcc1.PlatformLocation, decorators: [{
                type: core_1.Optional
            }] }, { type: ɵngcc2.InlineSVGConfig, decorators: [{
                type: core_1.Optional
            }] }, { type: ɵngcc3.HttpClient }, { type: ɵngcc3.HttpBackend }, { type: ɵngcc0.RendererFactory2 }]; }, null); })();
    return SVGCacheService;
}());
exports.SVGCacheService = SVGCacheService;

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ZnLWNhY2hlLnNlcnZpY2UuanMiLCJzb3VyY2VzIjpbInN2Zy1jYWNoZS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBSU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztnSUFBd0I7QUFDeEI7QUFDQTtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn07XHJcbnZhciBfX21ldGFkYXRhID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKGssIHYpO1xyXG59O1xyXG52YXIgX19wYXJhbSA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIGNvbW1vbl8xID0gcmVxdWlyZShcIkBhbmd1bGFyL2NvbW1vblwiKTtcclxudmFyIGh0dHBfMSA9IHJlcXVpcmUoXCJAYW5ndWxhci9jb21tb24vaHR0cFwiKTtcclxudmFyIGNvcmVfMSA9IHJlcXVpcmUoXCJAYW5ndWxhci9jb3JlXCIpO1xyXG52YXIgcnhqc18xID0gcmVxdWlyZShcInJ4anNcIik7XHJcbnZhciBvcGVyYXRvcnNfMSA9IHJlcXVpcmUoXCJyeGpzL29wZXJhdG9yc1wiKTtcclxudmFyIGlubGluZV9zdmdfY29uZmlnXzEgPSByZXF1aXJlKFwiLi9pbmxpbmUtc3ZnLmNvbmZpZ1wiKTtcclxudmFyIGkwID0gcmVxdWlyZShcIkBhbmd1bGFyL2NvcmVcIik7XHJcbnZhciBpMSA9IHJlcXVpcmUoXCJAYW5ndWxhci9jb21tb25cIik7XHJcbnZhciBpMiA9IHJlcXVpcmUoXCIuL2lubGluZS1zdmcuY29uZmlnXCIpO1xyXG52YXIgaTMgPSByZXF1aXJlKFwiQGFuZ3VsYXIvY29tbW9uL2h0dHBcIik7XHJcbnZhciBTVkdDYWNoZVNlcnZpY2UgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU1ZHQ2FjaGVTZXJ2aWNlKF9hcHBCYXNlLCBfbG9jYXRpb24sIF9jb25maWcsIGh0dHBDbGllbnQsIGh0dHBCYWNrZW5kLCByZW5kZXJlckZhY3RvcnkpIHtcclxuICAgICAgICB0aGlzLl9hcHBCYXNlID0gX2FwcEJhc2U7XHJcbiAgICAgICAgdGhpcy5fbG9jYXRpb24gPSBfbG9jYXRpb247XHJcbiAgICAgICAgdGhpcy5fY29uZmlnID0gX2NvbmZpZztcclxuICAgICAgICB0aGlzLl9odHRwID0gX2NvbmZpZyAmJiAhX2NvbmZpZy5ieXBhc3NIdHRwQ2xpZW50SW50ZXJjZXB0b3JDaGFpblxyXG4gICAgICAgICAgICA/IGh0dHBDbGllbnRcclxuICAgICAgICAgICAgOiBuZXcgaHR0cF8xLkh0dHBDbGllbnQoaHR0cEJhY2tlbmQpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXJGYWN0b3J5LmNyZWF0ZVJlbmRlcmVyKG51bGwsIG51bGwpO1xyXG4gICAgICAgIHRoaXMuc2V0QmFzZVVybCgpO1xyXG4gICAgICAgIGlmICghU1ZHQ2FjaGVTZXJ2aWNlXzEuX2NhY2hlKSB7XHJcbiAgICAgICAgICAgIFNWR0NhY2hlU2VydmljZV8xLl9jYWNoZSA9IG5ldyBNYXAoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFTVkdDYWNoZVNlcnZpY2VfMS5faW5Qcm9ncmVzc1JlcXMpIHtcclxuICAgICAgICAgICAgU1ZHQ2FjaGVTZXJ2aWNlXzEuX2luUHJvZ3Jlc3NSZXFzID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFNWR0NhY2hlU2VydmljZV8xID0gU1ZHQ2FjaGVTZXJ2aWNlO1xyXG4gICAgU1ZHQ2FjaGVTZXJ2aWNlLnByb3RvdHlwZS5nZXRTVkcgPSBmdW5jdGlvbiAodXJsLCByZXNvbHZlU1ZHVXJsLCBjYWNoZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNhY2hlID09PSB2b2lkIDApIHsgY2FjaGUgPSB0cnVlOyB9XHJcbiAgICAgICAgdmFyIHN2Z1VybCA9IHJlc29sdmVTVkdVcmxcclxuICAgICAgICAgICAgPyB0aGlzLmdldEFic29sdXRlVXJsKHVybClcclxuICAgICAgICAgICAgOiB1cmw7XHJcbiAgICAgICAgaWYgKGNhY2hlICYmIFNWR0NhY2hlU2VydmljZV8xLl9jYWNoZS5oYXMoc3ZnVXJsKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcnhqc18xLm9mKHRoaXMuX2Nsb25lU1ZHKFNWR0NhY2hlU2VydmljZV8xLl9jYWNoZS5nZXQoc3ZnVXJsKSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoU1ZHQ2FjaGVTZXJ2aWNlXzEuX2luUHJvZ3Jlc3NSZXFzLmhhcyhzdmdVcmwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTVkdDYWNoZVNlcnZpY2VfMS5faW5Qcm9ncmVzc1JlcXMuZ2V0KHN2Z1VybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXEgPSB0aGlzLl9odHRwLmdldChzdmdVcmwsIHsgcmVzcG9uc2VUeXBlOiAndGV4dCcgfSlcclxuICAgICAgICAgICAgLnBpcGUob3BlcmF0b3JzXzEuZmluYWxpemUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBTVkdDYWNoZVNlcnZpY2VfMS5faW5Qcm9ncmVzc1JlcXMuZGVsZXRlKHN2Z1VybCk7XHJcbiAgICAgICAgfSksIG9wZXJhdG9yc18xLnNoYXJlKCksIG9wZXJhdG9yc18xLm1hcChmdW5jdGlvbiAoc3ZnVGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgc3ZnRWwgPSBfdGhpcy5fc3ZnRWxlbWVudEZyb21TdHJpbmcoc3ZnVGV4dCk7XHJcbiAgICAgICAgICAgIFNWR0NhY2hlU2VydmljZV8xLl9jYWNoZS5zZXQoc3ZnVXJsLCBzdmdFbCk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5fY2xvbmVTVkcoc3ZnRWwpO1xyXG4gICAgICAgIH0pKTtcclxuICAgICAgICBTVkdDYWNoZVNlcnZpY2VfMS5faW5Qcm9ncmVzc1JlcXMuc2V0KHN2Z1VybCwgcmVxKTtcclxuICAgICAgICByZXR1cm4gcmVxO1xyXG4gICAgfTtcclxuICAgIFNWR0NhY2hlU2VydmljZS5wcm90b3R5cGUuc2V0QmFzZVVybCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fY29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Jhc2VVcmwgPSB0aGlzLl9jb25maWcuYmFzZVVybDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5fYXBwQmFzZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9iYXNlVXJsID0gdGhpcy5fYXBwQmFzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5fbG9jYXRpb24gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fYmFzZVVybCA9IHRoaXMuX2xvY2F0aW9uLmdldEJhc2VIcmVmRnJvbURPTSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTVkdDYWNoZVNlcnZpY2UucHJvdG90eXBlLmdldEFic29sdXRlVXJsID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9iYXNlVXJsICYmICEvXmh0dHBzPzpcXC9cXC8vaS50ZXN0KHVybCkpIHtcclxuICAgICAgICAgICAgdXJsID0gdGhpcy5fYmFzZVVybCArIHVybDtcclxuICAgICAgICAgICAgaWYgKHVybC5pbmRleE9mKCcvLycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB1cmwgPSB1cmwuc3Vic3RyaW5nKDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBiYXNlID0gdGhpcy5fcmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnQkFTRScpO1xyXG4gICAgICAgIGJhc2UuaHJlZiA9IHVybDtcclxuICAgICAgICByZXR1cm4gYmFzZS5ocmVmO1xyXG4gICAgfTtcclxuICAgIFNWR0NhY2hlU2VydmljZS5wcm90b3R5cGUuX3N2Z0VsZW1lbnRGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgICAgIHZhciBkaXYgPSB0aGlzLl9yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICBkaXYuaW5uZXJIVE1MID0gc3RyO1xyXG4gICAgICAgIHZhciBzdmcgPSBkaXYucXVlcnlTZWxlY3Rvcignc3ZnJyk7XHJcbiAgICAgICAgaWYgKCFzdmcpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBTVkcgZm91bmQgaW4gbG9hZGVkIGNvbnRlbnRzJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdmc7XHJcbiAgICB9O1xyXG4gICAgU1ZHQ2FjaGVTZXJ2aWNlLnByb3RvdHlwZS5fY2xvbmVTVkcgPSBmdW5jdGlvbiAoc3ZnKSB7XHJcbiAgICAgICAgcmV0dXJuIHN2Zy5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIFNWR0NhY2hlU2VydmljZV8xO1xyXG4gICAgU1ZHQ2FjaGVTZXJ2aWNlLm5nSW5qZWN0YWJsZURlZiA9IGkwLsm1ybVkZWZpbmVJbmplY3RhYmxlKHsgZmFjdG9yeTogZnVuY3Rpb24gU1ZHQ2FjaGVTZXJ2aWNlX0ZhY3RvcnkoKSB7IHJldHVybiBuZXcgU1ZHQ2FjaGVTZXJ2aWNlKGkwLsm1ybVpbmplY3QoaTEuQVBQX0JBU0VfSFJFRiwgOCksIGkwLsm1ybVpbmplY3QoaTEuUGxhdGZvcm1Mb2NhdGlvbiwgOCksIGkwLsm1ybVpbmplY3QoaTIuSW5saW5lU1ZHQ29uZmlnLCA4KSwgaTAuybXJtWluamVjdChpMy5IdHRwQ2xpZW50KSwgaTAuybXJtWluamVjdChpMy5IdHRwQmFja2VuZCksIGkwLsm1ybVpbmplY3QoaTAuUmVuZGVyZXJGYWN0b3J5MikpOyB9LCB0b2tlbjogU1ZHQ2FjaGVTZXJ2aWNlLCBwcm92aWRlZEluOiBcInJvb3RcIiB9KTtcclxuICAgIFNWR0NhY2hlU2VydmljZSA9IFNWR0NhY2hlU2VydmljZV8xID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY29yZV8xLkluamVjdGFibGUoe1xyXG4gICAgICAgICAgICBwcm92aWRlZEluOiAncm9vdCdcclxuICAgICAgICB9KSxcclxuICAgICAgICBfX3BhcmFtKDAsIGNvcmVfMS5PcHRpb25hbCgpKSwgX19wYXJhbSgwLCBjb3JlXzEuSW5qZWN0KGNvbW1vbl8xLkFQUF9CQVNFX0hSRUYpKSxcclxuICAgICAgICBfX3BhcmFtKDEsIGNvcmVfMS5PcHRpb25hbCgpKSxcclxuICAgICAgICBfX3BhcmFtKDIsIGNvcmVfMS5PcHRpb25hbCgpKSxcclxuICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZywgY29tbW9uXzEuUGxhdGZvcm1Mb2NhdGlvbixcclxuICAgICAgICAgICAgaW5saW5lX3N2Z19jb25maWdfMS5JbmxpbmVTVkdDb25maWcsXHJcbiAgICAgICAgICAgIGh0dHBfMS5IdHRwQ2xpZW50LFxyXG4gICAgICAgICAgICBodHRwXzEuSHR0cEJhY2tlbmQsXHJcbiAgICAgICAgICAgIGNvcmVfMS5SZW5kZXJlckZhY3RvcnkyXSlcclxuICAgIF0sIFNWR0NhY2hlU2VydmljZSk7XHJcbiAgICByZXR1cm4gU1ZHQ2FjaGVTZXJ2aWNlO1xyXG59KCkpO1xyXG5leHBvcnRzLlNWR0NhY2hlU2VydmljZSA9IFNWR0NhY2hlU2VydmljZTtcclxuIl19